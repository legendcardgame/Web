<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Preregistros · Admin</title>
  <link rel="stylesheet" href="./styles.css" />
  <link rel="icon" href="../assets/favicon.png" />
  <style>
    /* ===== Login pantalla completa ===== */
    .login-screen{
      min-height:100dvh; display:flex; align-items:center; justify-content:center;
      background: radial-gradient(1200px 600px at 50% -10%, rgba(232,69,60,.25), transparent 60%),
                  #0c0c0f;
      color:#fff; padding:24px;
    }
    .login-card{
      width:min(560px, 92vw);
      background:linear-gradient(180deg, #151519, #101013);
      border:1px solid #27272d; border-radius:16px;
      box-shadow:0 20px 50px rgba(0,0,0,.45);
      padding:24px;
    }
    .login-card h1{ margin:0 0 6px 0; font-size:1.6rem; }
    .login-sub{ opacity:.8; margin-bottom:16px; }
    .login-row{ display:flex; gap:10px; margin-top:14px; }
    .input{ background:#111216; border:1px solid #2a2a30; border-radius:12px; padding:.65rem .8rem; color:#fff; width:100%; }
    .btn{ background:#e8453c; border:none; color:#fff; padding:.7rem 1rem; border-radius:12px; cursor:pointer; }
    .btn:disabled{ opacity:.6; cursor:not-allowed; }
    .login-error{ color:#ff7b7b; min-height:1.2em; margin-top:8px; }

    /* ===== App ===== */
    .app{ display:none; min-height:100dvh; background:#0c0c0f; color:#fff; }
    .container{ max-width:1100px; margin:0 auto; padding:16px; }
    h1{ margin:16px 0 6px; }
    .toolbar{ display:flex; align-items:center; gap:10px; margin:12px 0 6px; }
    .toolbar .input{ flex:1 1 auto; }
    .below-bar{ display:flex; justify-content:flex-start; margin-bottom:10px; }
    .kpi{ font-size:.95rem; opacity:.85; }
    .kpi b{ color:#fff; }
    .badge{ background:#222; border:1px solid #2a2a2a; border-radius:999px; padding:6px 10px; font-size:.9rem; }
    .tag{ background:#222; border:1px solid #2a2a2a; padding:.1rem .45rem; border-radius:8px; }
    .tag.ok{ border-color:#2e7d32; color:#a5e6a8; }
    .tag.err{ border-color:#b71c1c; color:#ffb2b2; }
    .tag.warn{ border-color:#9e6b00; color:#ffd787; }
    .status{ background:#111; border:1px solid #333; border-radius:8px; padding:.35rem .5rem; color:#fff; }

    .table-wrapper{ position:relative; min-height:40dvh; }
    table{ width:100%; border-collapse:separate; border-spacing:0 8px; }
    thead th{ text-align:left; font-weight:700; }
    tbody td{ background:#0e0e10; border:1px solid #1f1f24; padding:.65rem .75rem; }
    tbody tr.updating td{ opacity:.65; }
    .hide-sm{ display:none; }
    @media (min-width:720px){ .hide-sm{ display:table-cell; } }

    .notice{ margin:8px 0; min-height:1.2em; }

    /* ===== Loader centrado ===== */
    .center-loader{
      position:absolute; inset:0; display:flex; align-items:center; justify-content:center;
    }
    .loader {
      display:flex; flex-direction:column; align-items:center; gap:10px;
      padding:12px 16px; background:rgba(16,16,20,.4); border:1px solid #26262c; border-radius:14px;
      backdrop-filter: blur(4px);
    }
    .loader .dots{ display:flex; gap:6px; }
    .loader .dots span{
      width:8px; height:8px; border-radius:50%; background:#e6e6e6; opacity:.6;
      animation: b 900ms infinite ease-in-out alternate;
    }
    .loader .dots span:nth-child(1){ animation-delay: 0ms; }
    .loader .dots span:nth-child(2){ animation-delay: 120ms; }
    .loader .dots span:nth-child(3){ animation-delay: 240ms; }
    .loader .dots span:nth-child(4){ animation-delay: 360ms; }
    @keyframes b { to{ transform: translateY(-6px); opacity:1; } }

    /* accesibilidad menor en móviles */
    @media (max-width:480px){
      .below-bar{ justify-content:flex-start; }
    }
  </style>
</head>
<body>

  <!-- LOGIN pantalla completa -->
  <section id="loginScreen" class="login-screen">
    <div class="login-card">
      <h1>Panel de Preregistros</h1>
      <div class="login-sub">Ingresa la clave de administrador para continuar.</div>
      <div class="login-row">
        <input id="adminKeyInput" class="input" type="password" placeholder="Clave de acceso" autocomplete="current-password">
        <button id="btnLogin" class="btn">Entrar</button>
      </div>
      <div id="loginMsg" class="login-error"></div>
    </div>
  </section>

  <!-- APP -->
  <section id="app" class="app">
    <main class="container">
      <h1>Preregistros</h1>

      <!-- Buscador -->
      <div class="toolbar">
        <input id="search" class="input" placeholder="Filtrar por Konami ID, nombre, apellidos, correo o teléfono…" />
      </div>

      <!-- KPI debajo (móvil friendly) -->
      <div class="below-bar">
        <div class="kpi">Jugadores: <b id="counter">0</b></div>
      </div>

      <!-- Mensajes -->
      <div id="out" class="notice"></div>

      <!-- Tabla + loader -->
      <div class="table-wrapper">
        <!-- Loader centrado -->
        <div id="centerLoader" class="center-loader" style="display:none;">
          <div class="loader" role="status" aria-live="polite">
            <div> Cargando… </div>
            <div class="dots" aria-hidden="true"><span></span><span></span><span></span><span></span></div>
          </div>
        </div>

        <table>
          <thead>
            <tr>
              <th class="hide-sm">Fecha</th>
              <th>Konami ID</th>
              <th>Nombre</th>
              <th>Apellidos</th>
              <th class="hide-sm">Correo</th>
              <th class="hide-sm">Teléfono</th>
              <th>Comprobante</th>
              <th>Estatus</th>
            </tr>
          </thead>
          <tbody id="tbody"></tbody>
        </table>
      </div>
    </main>
  </section>

  <!-- Config global -->
  <script src="./js/config.js" defer></script>
  <!-- Lógica admin -->
  <script src="./js/admin.js" defer></script>
</body>
</html>
